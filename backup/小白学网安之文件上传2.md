首先来引入一个概念，也就是相对路径和绝对路径。这里具有一定的前置知识，也就是对于linux系统有所掌握
在文件包含漏洞（LFI/RFI）和Linux系统操作中，**路径（相对路径/绝对路径）是核心基础**——渗透测试中能否成功读取敏感文件、执行恶意代码，本质上是对“目标文件路径定位”的掌握。以下结合Linux文件系统特性，从“基础概念→Linux专属规则→文件包含漏洞中的应用”三部分展开，兼顾理论与渗透实践：


## 一、先搞懂：Linux文件系统的核心规则（路径的前提）
Linux是**单根目录结构**，所有文件/目录都挂载在根目录 `/` 下（区别于Windows的多盘符C:/、D:/），这是理解Linux路径的关键。
这里如果还看不懂，需要自行下载一个linux系统并且尝试一下如何的正常操作。
### 1. Linux目录结构核心（渗透常用）
| 目录路径       | 作用                          | 渗透价值                          |
|----------------|-------------------------------|-----------------------------------|
| `/`            | 根目录（所有文件的“祖先目录”） | 绝对路径的起点                    |
| `/etc/`        | 系统配置文件目录              | 读取`passwd`（用户列表）、`ssh/sshd_config`（SSH配置） |
| `/var/log/`    | 日志文件目录                  | 读取Apache/Nginx日志（可能包含Cookie、账号密码）、系统日志 |
| `/home/[用户名]/` | 普通用户家目录                | 读取用户的配置文件（如`.bash_history`命令历史） |
| `/root/`       | root用户家目录（最高权限）    | 读取root的敏感文件（如私钥、脚本） |
| `/tmp/`        | 临时文件目录（所有用户可写）  | 上传恶意文件（如Webshell）后通过文件包含执行 |
| `/proc/`       | 系统进程信息目录              | 读取进程内存（如`/proc/[PID]/cmdline`查看进程命令行） |

### 2. 关键概念：当前工作目录（PWD）
路径的“相对/绝对”依赖于「当前脚本/进程所在的目录」，在Linux中用 `pwd` 命令查看：
- 例如：Web服务器（如Apache）的默认工作目录可能是 `/var/www/html/`，此时PHP脚本的“当前目录”就是该路径；
### - 渗透测试中，若能通过漏洞获取当前脚本路径（如报错信息泄露），可精准构造相对路径。这是非常之重要的


## 二、相对路径 vs 绝对路径（定义+Linux实例+文件包含应用）
### （一）绝对路径（Absolute Path）
#### 1. 定义
从**根目录 `/`** 开始，完整描述文件/目录的“全程路径”，无论当前在哪个目录，都能唯一定位目标。  
- 语法特征：路径以 `/` 开头。

#### 2. Linux实例（日常操作+渗透场景）
| 操作场景                | 绝对路径写法                  | 说明                              |
|-------------------------|-------------------------------|-----------------------------------|
| 读取系统用户列表        | `/etc/passwd`                 | 渗透中LFI最常用的目标文件（无需权限） |
| 读取Apache访问日志      | `/var/log/apache2/access.log` | 若日志包含用户输入（如GET参数），可注入恶意代码后包含执行 |
| 执行root家目录的脚本    | `/root/scripts/backup.sh`     | 需root权限，渗透中可通过提权后读取 |

#### 3. 在文件包含漏洞中的应用（LFI）
当Web应用允许包含“用户可控的绝对路径”时，可直接指定系统敏感文件，无需关心当前脚本目录：  
- 漏洞代码示例（PHP）：
  ```php
  <?php
  $file = $_GET['file']; // 用户可控参数
  include($file); // 无过滤直接包含
  ?>
  ```
- 渗透利用（直接传入绝对路径）：
  ```
  http://target.com/lfi.php?file=/etc/passwd
  http://target.com/lfi.php?file=/var/log/nginx/access.log
  ```
- 核心优势：**无需猜测当前脚本目录**，直接定位系统级敏感文件，成功率高。


### （二）相对路径（Relative Path）
#### 1. 定义
从**当前工作目录**开始，以“当前目录为起点”描述目标文件的路径，依赖于“当前所在位置”。  
- 语法特征：路径**不以 `/` 开头**，常用特殊符号表示目录关系：
  | 符号 | 含义                  | 渗透核心用途                  |
  |------|-----------------------|-------------------------------|
  | `.`  | 表示“当前目录”        | 可省略（如`./test.txt`= `test.txt`） |
  | `..` | 表示“上一级目录”（关键） | 路径穿越（目录回溯），突破当前目录限制 |
  | `../..` | 表示“上两级目录”      | 多层回溯，直达根目录或目标目录 |

#### 2. Linux实例（日常操作+渗透场景）
假设当前工作目录是 `/var/www/html/`（Web服务器默认目录），目标文件是 `/etc/passwd`：
| 目标文件                | 相对路径写法                  | 逻辑推导（从当前目录出发）       |
|-------------------------|-------------------------------|----------------------------------|
| `/etc/passwd`           | `../../etc/passwd`            | 当前目录`html` → 上一级`www` → 上一级`var` → 上一级`/` → 进入`etc` → `passwd` |
| `/tmp/malicious.php`    | `../../tmp/malicious.php`     | 当前目录`html` → 回溯到`/` → 进入`tmp` |
| 同目录下的`config.php`  | `config.php` 或 `./config.php` | 直接访问当前目录文件             |

#### 3. 在文件包含漏洞中的应用（核心：路径穿越）
当Web应用限制“只能包含当前目录下的文件”时，可通过 `../` 回溯目录，读取上级/系统级文件（渗透测试中最常用的LFI利用方式）。  

- 漏洞场景：Web脚本在 `/var/www/html/admin/` 目录下，代码如下（无过滤`../`）：
  ```php
  <?php
  $file = $_GET['file'];
  include("./includes/" . $file); // 拼接当前目录下的includes子目录
  ?>
  ```
- 渗透利用（通过`../`回溯）：
  目标：读取 `/etc/passwd`  
  路径推导：`./includes/` + `../../../../etc/passwd` → 最终路径为 `/var/www/html/admin/includes/../../../../etc/passwd`  
  简化后：`/etc/passwd`（因为`../../../../`从`admin/includes`回溯4级到根目录`/`）  
  最终Payload：
  ```
  http://target.com/admin/lfi.php?file=../../../../etc/passwd
  ```

- 关键技巧：
  - 若不确定回溯层数，可多写几个`../`（如`../../../../../../etc/passwd`），Linux会自动忽略多余的`../`（例如从根目录`/`再回溯，仍停留在`/`）；
  - 若应用过滤了`../`，可尝试URL编码绕过（`../` → `%2e%2e%2f`）或双写绕过（`....//` → 服务器过滤`../`后剩余`../`）。


## 三、核心区别与渗透测试关键注意点
### 1. 相对路径 vs 绝对路径（对比表）
| 维度         | 相对路径                          | 绝对路径                          |
|--------------|-----------------------------------|-----------------------------------|
| 起点         | 当前工作目录                      | 根目录 `/`                        |
| 语法特征     | 不以 `/` 开头，含 `.`/`..`        | 以 `/` 开头，全程完整路径         |
| 依赖条件     | 需知道当前脚本/进程的目录          | 无需知道当前目录，直接定位        |
| 渗透场景     | 突破“当前目录限制”（路径穿越）    | 直接读取系统敏感文件（无目录限制） |
| 成功率       | 依赖回溯层数和是否过滤`../`        | 高（只要权限允许，直接命中）      |

### 2. Linux特有的路径陷阱与渗透技巧
- （1）符号链接（软链接）：Linux中`/proc/self/root` 是根目录 `/` 的软链接，若`/etc/passwd`被限制，可尝试 `../../proc/self/root/etc/passwd` 绕过；
- （2）`/dev/null` 截断：早期PHP版本中，若路径后拼接了后缀（如`include($file . ".php")`），可通过`../../etc/passwd%00`（NULL截断）去掉后缀（需`magic_quotes_gpc=off`）；
- （3）日志文件路径：Linux日志默认路径固定（如Apache日志`/var/log/apache2/access.log`、Nginx日志`/var/log/nginx/access.log`），可直接用绝对路径包含，注入恶意代码（如在User-Agent中插入`<?php phpinfo();?>`，再包含日志文件执行）；
- （4）权限限制：即使路径正确，若Web服务器用户（如www-data）无读取权限，也会失败（例如`/root/.ssh/id_rsa`需root权限，普通用户无法读取）。


## 四、总结（渗透测试核心结论）
1. 绝对路径是“直接命中”：渗透中优先尝试绝对路径（如`/etc/passwd`），无需纠结当前目录，成功率最高；
2. 相对路径是“迂回突破”：当绝对路径被限制（如应用过滤`/`），用`../`回溯目录，多试几层（如`../../../../`），利用Linux路径容错性；
3. 牢记Linux敏感文件的绝对路径：这是LFI漏洞利用的“弹药库”，核心目标包括：
   - `/etc/passwd`（用户列表）、`/etc/shadow`（密码哈希，需root权限）；
   - `/var/log/[服务名]/access.log`（日志注入）；
   - `/home/[用户名]/.bash_history`（命令历史，可能包含密码）；
   - `/proc/version`（系统内核版本，用于提权漏洞判断）。

通过以上知识，可解决文件包含漏洞中“如何构造路径”的核心问题——本质上，LFI的利用就是“用正确的路径，找到可读取/可执行的目标文件”，而Linux的路径规则是实现这一目标的基础。
稍等一下，研究一下怎么补充图片再讲一下伪装马。